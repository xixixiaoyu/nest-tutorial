<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NestJS æä¾›è€… (Provider) è¯¦è§£</title>
    <style>
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji',
          'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
        line-height: 1.7;
        color: #333;
        background-color: #f9f9f9;
        margin: 0;
        padding: 0;
      }
      .container {
        max-width: 900px;
        margin: 20px auto;
        background-color: #fff;
        padding: 30px 40px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }
      h1,
      h2,
      h3 {
        color: #2c3e50;
        border-bottom: 1px solid #eee;
        padding-bottom: 10px;
        margin-top: 1.5em;
        margin-bottom: 1em;
      }
      h1 {
        text-align: center;
        margin-top: 0;
        border-bottom: 2px solid #3498db;
        font-size: 2.2em;
      }
      h2 {
        font-size: 1.8em;
        color: #3498db;
      }
      h3 {
        font-size: 1.4em;
        color: #16a085;
        border-bottom: none;
      }
      p {
        margin-bottom: 1em;
      }
      code {
        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
        background-color: #ecf0f1;
        padding: 0.2em 0.4em;
        border-radius: 3px;
        font-size: 0.9em;
        color: #c0392b; /* æ›´é†’ç›®çš„é¢œè‰² */
      }
      pre {
        background-color: #2d2d2d; /* æ·±è‰²èƒŒæ™¯ */
        color: #f8f8f2; /* äº®è‰²æ–‡å­— */
        padding: 15px;
        border-radius: 5px;
        overflow-x: auto;
        font-size: 0.9em;
        line-height: 1.5;
        margin: 1.5em 0;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
      }
      pre code {
        background-color: transparent;
        padding: 0;
        color: inherit; /* ç»§æ‰¿ pre çš„é¢œè‰² */
        font-size: inherit; /* ç»§æ‰¿ pre çš„å­—å· */
      }
      .code-comment {
        color: #7f8c8d; /* æ³¨é‡Šé¢œè‰² */
        font-style: italic;
      }
      .code-keyword {
        color: #f92672; /* å…³é”®å­—é¢œè‰² (ç²‰è‰²) */
        font-weight: bold;
      }
      .code-decorator {
        color: #a6e22e; /* è£…é¥°å™¨é¢œè‰² (ç»¿è‰²) */
      }
      .code-string {
        color: #e6db74; /* å­—ç¬¦ä¸²é¢œè‰² (é»„è‰²) */
      }
      .code-class {
        color: #66d9ef; /* ç±»åé¢œè‰² (è“è‰²) */
      }
      .code-function {
        color: #a6e22e; /* å‡½æ•°åé¢œè‰² (ç»¿è‰²) */
      }
      .code-number {
        color: #ae81ff; /* æ•°å­—é¢œè‰² (ç´«è‰²) */
      }
      .analogy {
        background-color: #e8f4fd;
        border-left: 4px solid #3498db;
        padding: 15px;
        margin: 1.5em 0;
        font-style: italic;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin: 1.5em 0;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 10px 12px;
        text-align: left;
      }
      th {
        background-color: #f2f2f2;
        font-weight: bold;
        color: #555;
      }
      tr:nth-child(even) {
        background-color: #f9f9f9;
      }
      .highlight {
        background-color: #fff3cd;
        padding: 2px 5px;
        border-radius: 3px;
        font-weight: bold;
      }
      .date-time {
        text-align: right;
        font-size: 0.85em;
        color: #7f8c8d;
        margin-bottom: 20px;
      }
      ul {
        padding-left: 20px;
      }
      li {
        margin-bottom: 0.5em;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>NestJS æä¾›è€… (Provider) è¯¦è§£</h1>

      <section>
        <p class="analogy">
          ğŸ’¡ åœ¨ Nest çš„ä¸–ç•Œé‡Œï¼Œæä¾›è€…ï¼ˆProviderï¼‰å°±åƒæ˜¯åº”ç”¨ç¨‹åºçš„
          <strong class="highlight">"ä¸“ä¸šå·¥åŒ "</strong>ã€‚<br />
          å¦‚æœæŠŠåº”ç”¨æ¯”ä½œä¸€åº§æˆ¿å­ï¼Œé‚£ä¹ˆæä¾›è€…å°±æ˜¯ç”µå·¥ã€æœ¨åŒ ã€æ°´ç®¡å·¥è¿™äº›å„å¸å…¶èŒçš„ä¸“ä¸šäººå£«ã€‚<br />
          æ¯ä¸ªæä¾›è€…éƒ½æœ‰è‡ªå·±çš„ä¸“é•¿ï¼Œé€šè¿‡
          <strong class="highlight">ä¾èµ–æ³¨å…¥ (Dependency Injection)</strong>
          çš„æ–¹å¼ä¸ºåº”ç”¨æä¾›æœåŠ¡ã€‚
        </p>
      </section>

      <section>
        <h2>ä»€ä¹ˆæ˜¯æä¾›è€…ï¼Ÿ</h2>
        <p>
          æä¾›è€…æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯ä»¥è¢«æ³¨å…¥åˆ°å…¶ä»–ç±»ä¸­çš„ç±»ã€‚å®ƒä»¬æ‰¿æ‹…ç€ä¸åŒçš„èŒè´£ï¼š
        </p>
        <ul>
          <li><strong>æœåŠ¡ (Service)ï¼š</strong> å¤„ç†ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®æ“ä½œ</li>
          <li><strong>ä»“åº“ (Repository)ï¼š</strong> ä¸“é—¨è´Ÿè´£ä¸æ•°æ®åº“æ‰“äº¤é“</li>
          <li><strong>å·¥å‚ (Factory)ï¼š</strong> è´Ÿè´£åˆ›å»ºå¤æ‚å¯¹è±¡</li>
          <li><strong>è¾…åŠ©ç±» (Helper)ï¼š</strong> æä¾›å„ç§é€šç”¨åŠŸèƒ½</li>
        </ul>
        <p>
          æä¾›è€…æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥é€šè¿‡
          <strong class="highlight">ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰</strong>
          çš„æ–¹å¼è¢« "é€è¾¾" åˆ°éœ€è¦å®ƒä»¬çš„åœ°æ–¹ï¼Œè¿™è®©ä»£ç å˜å¾—æ›´åŠ 
          <strong class="highlight">æ¨¡å—åŒ–</strong> å’Œ
          <strong class="highlight">å¯æµ‹è¯•</strong>ã€‚
        </p>
      </section>

      <section>
        <h2>åˆ›å»ºä½ çš„ä¸€ä¸ªæœåŠ¡ (Service)</h2>
        <p>
          è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®¡ç†çŒ«å’ªä¿¡æ¯çš„ä¾‹å­æ¥äº†è§£å¦‚ä½•åˆ›å»ºæœåŠ¡ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦ä¸€ä¸ª
          <code>CatsService</code> æ¥å¤„ç†æ‰€æœ‰å…³äºçŒ«å’ªçš„æ“ä½œï¼š
        </p>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { Injectable } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;
<span class="code-keyword">import</span> { Cat } <span class="code-keyword">from</span> <span class="code-string">'./interfaces/cat.interface'</span>;

<span class="code-decorator">@Injectable()</span> <span class="code-comment">// è¿™ä¸ªè£…é¥°å™¨æ˜¯å…³é”®</span>
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">CatsService</span> {
  <span class="code-keyword">private</span> <span class="code-keyword">readonly</span> cats: Cat[] = []; <span class="code-comment">// ç”¨æ•°ç»„æ¨¡æ‹Ÿæ•°æ®åº“</span>

  <span class="code-function">create</span>(cat: Cat) {
    <span class="code-keyword">this</span>.cats.<span class="code-function">push</span>(cat);
    console.<span class="code-function">log</span>(<span class="code-string">'ä¸€åªæ–°çŒ«å’ªåŠ å…¥äº†ï¼ç°åœ¨æœ‰'</span>, <span class="code-keyword">this</span>.cats.length, <span class="code-string">'åªçŒ«å’ªã€‚'</span>);
  }

  <span class="code-function">findAll</span>(): Cat[] {
    console.<span class="code-function">log</span>(<span class="code-string">'æ­£åœ¨æŸ¥æ‰¾æ‰€æœ‰çŒ«å’ª...'</span>);
    <span class="code-keyword">return</span> <span class="code-keyword">this</span>.cats;
  }
}</code></pre>
        <p>
          <code>@Injectable()</code> è£…é¥°å™¨ç›¸å½“äºå‘Šè¯‰ Nestï¼š<code
            >CatsService</code
          >
          è¿™ä¸ªç±»æ˜¯ä¸ªæä¾›è€…ï¼Œä½ å¯ä»¥ç®¡ç†å®ƒï¼Œä¹Ÿå¯ä»¥æŠŠå®ƒ â€˜æ³¨å…¥â€™ ç»™åˆ«äººç”¨ã€‚
        </p>
      </section>

      <section>
        <h2>åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨æœåŠ¡</h2>
        <p>
          ç°åœ¨æˆ‘ä»¬æœ‰äº†
          <code>CatsService</code>ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å¦‚ä½•åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨å®ƒï¼š
        </p>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { Controller, Get, Post, Body } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;
<span class="code-keyword">import</span> { CreateCatDto } <span class="code-keyword">from</span> <span class="code-string">'./dto/create-cat.dto'</span>;
<span class="code-keyword">import</span> { CatsService } <span class="code-keyword">from</span> <span class="code-string">'./cats.service'</span>;
<span class="code-keyword">import</span> { Cat } <span class="code-keyword">from</span> <span class="code-string">'./interfaces/cat.interface'</span>;

<span class="code-decorator">@Controller</span>(<span class="code-string">'cats'</span>)
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">CatsController</span> {
  <span class="code-comment">// é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ CatsService</span>
  <span class="code-keyword">constructor</span>(<span class="code-keyword">private</span> <span class="code-keyword">readonly</span> catsService: CatsService) {}

  <span class="code-decorator">@Post()</span>
  <span class="code-keyword">async</span> <span class="code-function">create</span>(<span class="code-decorator">@Body()</span> createCatDto: CreateCatDto) {
    <span class="code-keyword">this</span>.catsService.<span class="code-function">create</span>(createCatDto);
    <span class="code-keyword">return</span> <span class="code-string">'æˆåŠŸæ·»åŠ äº†ä¸€åªçŒ«å’ªï¼'</span>;
  }

  <span class="code-decorator">@Get()</span>
  <span class="code-keyword">async</span> <span class="code-function">findAll</span>(): Promise&lt;Cat[]&gt; {
    <span class="code-keyword">return</span> <span class="code-keyword">this</span>.catsService.<span class="code-function">findAll</span>();
  }
}</code></pre>
        <p>
          è¿™é‡Œçš„å…³é”®æ˜¯æ„é€ å‡½æ•°ä¸­çš„
          <code>constructor(private readonly catsService: CatsService)</code>ã€‚
        </p>
        <p>
          ä½ åªéœ€è¦å£°æ˜éœ€è¦ä»€ä¹ˆç±»å‹çš„ä¾èµ–ï¼ŒNestJS
          å°±ä¼šè‡ªåŠ¨åˆ›å»ºå®ä¾‹å¹¶æ³¨å…¥è¿›æ¥ã€‚è¿™å°±æ˜¯
          <strong class="highlight">ä¾èµ–æ³¨å…¥çš„é­”æ³•</strong>ã€‚
        </p>
      </section>

      <section>
        <h2>æ³¨å†Œæä¾›è€…</h2>
        <p>
          å…‰å®šä¹‰æœåŠ¡è¿˜ä¸å¤Ÿï¼Œä½ è¿˜éœ€è¦å‘Šè¯‰ Nest
          è¿™ä¸ªæœåŠ¡çš„å­˜åœ¨ã€‚è¿™å°±éœ€è¦åœ¨æ¨¡å—ä¸­æ³¨å†Œå®ƒï¼š
        </p>

        <h3>1. åœ¨ç‰¹æ€§æ¨¡å—ä¸­æ³¨å†Œ (<code>cats.module.ts</code>)</h3>
        <pre><code class="language-typescript"><span class="code-comment">// cats.module.ts</span>
<span class="code-keyword">import</span> { Module } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;
<span class="code-keyword">import</span> { CatsController } <span class="code-keyword">from</span> <span class="code-string">'./cats.controller'</span>;
<span class="code-keyword">import</span> { CatsService } <span class="code-keyword">from</span> <span class="code-string">'./cats.service'</span>;

<span class="code-decorator">@Module</span>({
  controllers: [CatsController],
  providers: [CatsService], <span class="code-comment">// åœ¨è¿™é‡Œæ³¨å†ŒæœåŠ¡</span>
  exports: [CatsService],   <span class="code-comment">// å¦‚æœå…¶ä»–æ¨¡å—éœ€è¦ä½¿ç”¨ï¼Œè®°å¾—å¯¼å‡º</span>
})
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">CatsModule</span> {}</code></pre>

        <h3>2. åœ¨ä¸»æ¨¡å—ä¸­å¯¼å…¥ç‰¹æ€§æ¨¡å— (<code>app.module.ts</code>)</h3>
        <pre><code class="language-typescript"><span class="code-comment">// app.module.ts</span>
<span class="code-keyword">import</span> { Module } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;
<span class="code-keyword">import</span> { CatsModule } <span class="code-keyword">from</span> <span class="code-string">'./cats/cats.module'</span>;

<span class="code-decorator">@Module</span>({
  imports: [CatsModule], <span class="code-comment">// å¯¼å…¥ç‰¹æ€§æ¨¡å—</span>
})
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">AppModule</span> {}</code></pre>
        <p>
          å½“ Nest åˆå§‹åŒ– <code>CatsController</code> æ—¶ï¼Œå‘ç°å®ƒéœ€è¦
          <code>CatsService</code
          >ï¼Œä¾èµ–æ³¨å…¥ç³»ç»Ÿå°±ä¼šè‡ªåŠ¨æ‰¾åˆ°å·²æ³¨å†Œçš„æä¾›è€…ï¼Œå®ä¾‹åŒ–å®ƒå¹¶æ³¨å…¥åˆ°æ§åˆ¶å™¨ä¸­ã€‚
        </p>
      </section>

      <section>
        <h2>å¼‚æ­¥æä¾›è€…ï¼šå¤„ç†å¤æ‚çš„åˆå§‹åŒ–</h2>
        <p>
          æƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼šä½ çš„åº”ç”¨éœ€è¦åœ¨å¯åŠ¨æ—¶è¿æ¥æ•°æ®åº“ï¼Œåªæœ‰è¿æ¥æˆåŠŸåï¼Œå…¶ä»–æœåŠ¡æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚å¦‚æœç”¨ä¼ ç»Ÿæ–¹å¼ï¼Œä½ å¯èƒ½éœ€è¦å†™ä¸€å †å›è°ƒæˆ–è€…
          Promise é“¾ï¼Œä»£ç ä¼šå˜å¾—å¤æ‚ä¸”éš¾ä»¥ç»´æŠ¤ã€‚
        </p>
        <p>
          å¼‚æ­¥æä¾›è€…çš„è§£å†³æ–¹æ¡ˆéå¸¸ç›´è§‚ï¼Œå®ƒä½¿ç”¨ <code>async/await</code> é…åˆ
          <code>useFactory</code>ï¼š
        </p>

        <h3>1. ä½¿ç”¨ <code>useFactory</code> åˆ›å»ºå¼‚æ­¥æä¾›è€…</h3>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { DataSource } <span class="code-keyword">from</span> <span class="code-string">'typeorm'</span>;

<span class="code-comment">// åœ¨æ¨¡å—çš„ providers ä¸­é…ç½®</span>
{
  provide: <span class="code-string">'DATABASE_CONNECTION'</span>, <span class="code-comment">// æä¾›è€…çš„ Token</span>
  useFactory: <span class="code-keyword">async</span> (): Promise&lt;DataSource&gt; => {
    <span class="code-keyword">const</span> dataSource = <span class="code-keyword">new</span> <span class="code-class">DataSource</span>({
      type: <span class="code-string">'postgres'</span>,
      host: <span class="code-string">'localhost'</span>,
      port: <span class="code-number">5432</span>,
      database: <span class="code-string">'myapp'</span>,
      <span class="code-comment">// å…¶ä»–é…ç½®...</span>
    });

    <span class="code-keyword">await</span> dataSource.<span class="code-function">initialize</span>();
    console.<span class="code-function">log</span>(<span class="code-string">'æ•°æ®åº“è¿æ¥å»ºç«‹æˆåŠŸï¼'</span>);
    <span class="code-keyword">return</span> dataSource;
  },
}</code></pre>
        <p>
          Nest ä¼šæ™ºèƒ½åœ°æ£€æµ‹åˆ°ä½ çš„
          <code>useFactory</code> å‡½æ•°æ˜¯å¼‚æ­¥çš„ï¼Œç„¶åè€å¿ƒç­‰å¾… Promise
          å®Œæˆã€‚åªæœ‰å½“æ•°æ®åº“è¿æ¥çœŸæ­£å»ºç«‹åï¼Œé‚£äº›ä¾èµ–è¿™ä¸ªè¿æ¥çš„æœåŠ¡æ‰ä¼šå¼€å§‹å®ä¾‹åŒ–ã€‚
        </p>

        <h3>2. åœ¨æœåŠ¡ä¸­æ³¨å…¥å¼‚æ­¥æä¾›è€…</h3>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { Injectable, Inject } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;
<span class="code-keyword">import</span> { DataSource } <span class="code-keyword">from</span> <span class="code-string">'typeorm'</span>;
<span class="code-keyword">import</span> { User } <span class="code-keyword">from</span> <span class="code-string">'./entities/user.entity'</span>; <span class="code-comment">// å‡è®¾æœ‰ User å®ä½“</span>
<span class="code-keyword">import</span> { CreateUserDto } <span class="code-keyword">from</span> <span class="code-string">'./dto/create-user.dto'</span>; <span class="code-comment">// å‡è®¾æœ‰ DTO</span>

<span class="code-decorator">@Injectable()</span>
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">UserService</span> {
  <span class="code-keyword">constructor</span>(
    <span class="code-decorator">@Inject</span>(<span class="code-string">'DATABASE_CONNECTION'</span>) <span class="code-comment">// ä½¿ç”¨ Token æ³¨å…¥</span>
    <span class="code-keyword">private</span> <span class="code-keyword">readonly</span> dataSource: DataSource
  ) {}

  <span class="code-keyword">async</span> <span class="code-function">findAllUsers</span>() {
    <span class="code-keyword">const</span> userRepository = <span class="code-keyword">this</span>.dataSource.<span class="code-function">getRepository</span>(User);
    <span class="code-keyword">return</span> <span class="code-keyword">await</span> userRepository.<span class="code-function">find</span>();
  }

  <span class="code-keyword">async</span> <span class="code-function">createUser</span>(userData: CreateUserDto) {
    <span class="code-keyword">const</span> userRepository = <span class="code-keyword">this</span>.dataSource.<span class="code-function">getRepository</span>(User);
    <span class="code-keyword">const</span> user = userRepository.<span class="code-function">create</span>(userData);
    <span class="code-keyword">return</span> <span class="code-keyword">await</span> userRepository.<span class="code-function">save</span>(user);
  }
}</code></pre>

        <h3>3. ä¸ºå¼‚æ­¥å·¥å‚æ³¨å…¥ä¾èµ–</h3>
        <p>
          å¦‚æœä½ çš„å·¥å‚å‡½æ•°è¿˜éœ€è¦å…¶ä»–ä¾èµ–ï¼ˆä¾‹å¦‚é…ç½®æœåŠ¡ï¼‰ï¼Œå¯ä»¥é€šè¿‡
          <code>inject</code> å‚æ•°æ³¨å…¥ï¼š
        </p>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { Module } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;
<span class="code-keyword">import</span> { ConfigModule, ConfigService } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/config'</span>;
<span class="code-keyword">import</span> { DataSource } <span class="code-keyword">from</span> <span class="code-string">'typeorm'</span>;
<span class="code-keyword">import</span> { UserService } <span class="code-keyword">from</span> <span class="code-string">'./user.service'</span>; <span class="code-comment">// å‡è®¾ UserService åœ¨è¿™é‡Œå®šä¹‰æˆ–å¯¼å…¥</span>

<span class="code-decorator">@Module</span>({
  imports: [ConfigModule.<span class="code-function">forRoot</span>()], <span class="code-comment">// ç¡®ä¿ ConfigModule å·²é…ç½®</span>
  providers: [
    {
      provide: <span class="code-string">'DATABASE_CONNECTION'</span>,
      useFactory: <span class="code-keyword">async</span> (configService: ConfigService): Promise&lt;DataSource&gt; => {
        <span class="code-keyword">const</span> dbHost = configService.<span class="code-function">get</span>&lt;string&gt;(<span class="code-string">'DATABASE_HOST'</span>);
        <span class="code-keyword">const</span> dbPort = configService.<span class="code-function">get</span>&lt;number&gt;(<span class="code-string">'DATABASE_PORT'</span>);
        <span class="code-comment">// ... ä½¿ç”¨é…ç½®æœåŠ¡è·å–å…¶ä»–æ•°æ®åº“è¿æ¥ä¿¡æ¯</span>
        <span class="code-keyword">const</span> dataSource = <span class="code-keyword">new</span> <span class="code-class">DataSource</span>({
          type: <span class="code-string">'postgres'</span>,
          host: dbHost,
          port: dbPort,
          <span class="code-comment">// ... å…¶ä»–é…ç½®</span>
        });
        <span class="code-keyword">await</span> dataSource.<span class="code-function">initialize</span>();
        console.<span class="code-function">log</span>(<span class="code-string">'æ•°æ®åº“è¿æ¥æˆåŠŸ (ä½¿ç”¨é…ç½®)!'</span>);
        <span class="code-keyword">return</span> dataSource;
      },
      inject: [ConfigService], <span class="code-comment">// æ³¨å…¥ ConfigService åˆ° useFactory</span>
    },
    UserService, <span class="code-comment">// æ³¨å†Œéœ€è¦æ•°æ®åº“è¿æ¥çš„æœåŠ¡</span>
  ],
  exports: [<span class="code-string">'DATABASE_CONNECTION'</span>], <span class="code-comment">// å¯¼å‡ºè¿æ¥ï¼Œä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨</span>
})
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">DatabaseModule</span> {}</code></pre>
      </section>

      <section>
        <h2>æä¾›è€…çš„ä¸€äº›è¿›é˜¶ç©æ³•</h2>

        <h3>ä½œç”¨åŸŸ (Scope)</h3>
        <p>
          NestJS ä¸­çš„æä¾›è€…é»˜è®¤é‡‡ç”¨
          <strong class="highlight">å•ä¾‹æ¨¡å¼</strong
          >ï¼ˆæ•´ä¸ªåº”ç”¨å…±äº«ä¸€ä¸ªå®ä¾‹ï¼‰ï¼Œä½†å¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´ä½œç”¨åŸŸã€‚
        </p>

        <h4>1. DEFAULT (é»˜è®¤å•ä¾‹)</h4>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { Injectable } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;

<span class="code-decorator">@Injectable()</span> <span class="code-comment">// ç­‰åŒäº @Injectable({ scope: Scope.DEFAULT })</span>
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">UserService</span> {
  <span class="code-keyword">private</span> users: User[] = []; <span class="code-comment">// å‡è®¾ User ç±»å‹å·²å®šä¹‰</span>

  <span class="code-comment">// æ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…åªæœ‰ä¸€ä¸ªå®ä¾‹</span>
  <span class="code-comment">// æ‰€æœ‰æ¨¡å—å…±äº«åŒä¸€ä¸ªå®ä¾‹</span>
  <span class="code-keyword">constructor</span>() {
    console.<span class="code-function">log</span>(<span class="code-string">'UserService (Singleton) å®ä¾‹åˆ›å»º'</span>);
  }
}</code></pre>

        <h4>2. REQUEST (è¯·æ±‚ä½œç”¨åŸŸ)</h4>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { Injectable, Scope, Inject } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;
<span class="code-keyword">import</span> { REQUEST } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/core'</span>;
<span class="code-keyword">import</span> { Request } <span class="code-keyword">from</span> <span class="code-string">'express'</span>; <span class="code-comment">// å‡è®¾ä½¿ç”¨ Express</span>

<span class="code-decorator">@Injectable</span>({ scope: Scope.REQUEST })
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">RequestScopedService</span> {
  <span class="code-keyword">private</span> requestData: any = {};

  <span class="code-comment">// æ¯ä¸ª HTTP è¯·æ±‚åˆ›å»ºæ–°å®ä¾‹</span>
  <span class="code-comment">// é€‚åˆå­˜å‚¨è¯·æ±‚ç‰¹æœ‰çš„ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€è¯·æ±‚IDç­‰ï¼‰</span>
  <span class="code-keyword">constructor</span>(<span class="code-decorator">@Inject</span>(REQUEST) <span class="code-keyword">private</span> request: Request) {
    console.<span class="code-function">log</span>(<span class="code-string">'RequestScopedService å®ä¾‹åˆ›å»º for request:'</span>, <span class="code-keyword">this</span>.request.id);
    <span class="code-comment">// å¯ä»¥è®¿é—®æ³¨å…¥çš„ request å¯¹è±¡</span>
  }
}</code></pre>
        <p>
          <strong class="highlight">æ³¨æ„ï¼š</strong>
          è¯·æ±‚ä½œç”¨åŸŸçš„æä¾›è€…ä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½å¼€é”€ï¼Œå› ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦åˆ›å»ºå®ä¾‹ã€‚åªæœ‰åœ¨ç¡®å®éœ€è¦æŒ‰è¯·æ±‚éš”ç¦»çŠ¶æ€æ—¶æ‰ä½¿ç”¨ã€‚
        </p>

        <h4>3. TRANSIENT (ç¬æ€ä½œç”¨åŸŸ)</h4>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { Injectable, Scope } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;

<span class="code-decorator">@Injectable</span>({ scope: Scope.TRANSIENT })
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">TransientService</span> {
  <span class="code-keyword">private</span> instanceId = Math.<span class="code-function">random</span>().<span class="code-function">toString</span>(<span class="code-number">36</span>).<span class="code-function">substring</span>(<span class="code-number">7</span>);

  <span class="code-comment">// æ¯æ¬¡æ³¨å…¥éƒ½åˆ›å»ºæ–°å®ä¾‹</span>
  <span class="code-comment">// å®Œå…¨ç‹¬ç«‹çš„çŠ¶æ€ç®¡ç†</span>
  <span class="code-keyword">constructor</span>() {
    console.<span class="code-function">log</span>(<span class="code-string">`TransientService å®ä¾‹åˆ›å»ºï¼ŒID: </span><span class="code-interpolation">${<span class="code-keyword">this</span>.instanceId}</span><span class="code-string">`</span>);
  }
}</code></pre>
        <p>
          <strong class="highlight">æ³¨æ„ï¼š</strong>
          ç¬æ€æä¾›è€…æ¯æ¬¡è¢«æ³¨å…¥æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ã€ç‹¬äº«çš„å®ä¾‹ã€‚å¦‚æœ A ä¾èµ– Bï¼ŒB
          ä¾èµ– C (Transient)ï¼Œé‚£ä¹ˆ A å’Œ B ä¼šå…±äº«åŒä¸€ä¸ª C å®ä¾‹ã€‚ä½†å¦‚æœ A å’Œ D
          éƒ½ä¾èµ– C (Transient)ï¼Œåˆ™ A å’Œ D ä¼šåˆ†åˆ«è·å¾—ä¸åŒçš„ C å®ä¾‹ã€‚
        </p>

        <h4>ä½¿ç”¨åœºæ™¯å¯¹æ¯”</h4>
        <table>
          <thead>
            <tr>
              <th>ä½œç”¨åŸŸ</th>
              <th>æ€§èƒ½</th>
              <th>å†…å­˜å ç”¨</th>
              <th>é€‚ç”¨åœºæ™¯</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>DEFAULT</code> (å•ä¾‹)</td>
              <td>æœ€ä¼˜</td>
              <td>æœ€ä½</td>
              <td>æ— çŠ¶æ€æœåŠ¡ã€å·¥å…·ç±»ã€æ•°æ®åº“è¿æ¥æ± ã€é…ç½®æœåŠ¡ç­‰å…±äº«èµ„æº</td>
            </tr>
            <tr>
              <td><code>REQUEST</code> (è¯·æ±‚)</td>
              <td>ä¸­ç­‰ (æœ‰å¼€é”€)</td>
              <td>ä¸­ç­‰ (éšè¯·æ±‚æ•°å¢åŠ )</td>
              <td>
                éœ€è¦åŸºäºæ¯ä¸ªè¯·æ±‚å­˜å‚¨ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·è®¤è¯æ•°æ®ã€è¯·æ±‚è¿½è¸ª
                IDã€è¯·æ±‚çº§ç¼“å­˜
              </td>
            </tr>
            <tr>
              <td><code>TRANSIENT</code> (ç¬æ€)</td>
              <td>è¾ƒå·® (é¢‘ç¹åˆ›å»º)</td>
              <td>è¾ƒé«˜ (å®ä¾‹å¤š)</td>
              <td>éœ€è¦ä¸ºæ¯ä¸ªæ³¨å…¥ç‚¹æä¾›å®Œå…¨éš”ç¦»çŠ¶æ€çš„ç‰¹æ®Šåœºæ™¯ï¼Œä¸å¸¸ç”¨</td>
            </tr>
          </tbody>
        </table>

        <h3>å¯é€‰ä¾èµ–</h3>
        <p>
          æœ‰æ—¶æŸäº›ä¾èµ–ä¸æ˜¯å¿…éœ€çš„ï¼Œå¯ä»¥ä½¿ç”¨ <code>@Optional()</code> è£…é¥°å™¨ã€‚å¦‚æœ
          Nest æ— æ³•è§£æè¯¥ä¾èµ–ï¼ˆä¾‹å¦‚ï¼Œæä¾›è€…æœªæ³¨å†Œï¼‰ï¼Œå®ƒå°†æ³¨å…¥
          <code>undefined</code> è€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯ã€‚
        </p>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { Injectable, Optional, Inject } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;

<span class="code-comment">// å‡è®¾æœ‰ä¸€ä¸ª AnalyticsServiceï¼Œä½†å®ƒå¯èƒ½æ²¡æœ‰åœ¨æ‰€æœ‰ç¯å¢ƒä¸­éƒ½æ³¨å†Œ</span>
<span class="code-comment">// @Injectable()</span>
<span class="code-comment">// export class AnalyticsService {</span>
<span class="code-comment">//   track(event: string) { console.log(`Tracking event: ${event}`); }</span>
<span class="code-comment">// }</span>

<span class="code-decorator">@Injectable()</span>
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">AppService</span> {
  <span class="code-keyword">constructor</span>(
    <span class="code-decorator">@Optional()</span> <span class="code-comment">// æ ‡è®°ä¸ºå¯é€‰ä¾èµ–</span>
    <span class="code-comment">// @Inject('ANALYTICS_SERVICE_TOKEN') // å¦‚æœä½¿ç”¨ tokenï¼Œä¹Ÿéœ€è¦ @Optional</span>
    <span class="code-keyword">private</span> <span class="code-keyword">readonly</span> analyticsService?: AnalyticsService <span class="code-comment">// ç±»å‹è®¾ä¸ºå¯é€‰</span>
  ) {
    <span class="code-comment">// analyticsService å¯èƒ½ä¸º undefined</span>
    <span class="code-keyword">if</span> (<span class="code-keyword">this</span>.analyticsService) {
      <span class="code-keyword">this</span>.analyticsService.<span class="code-function">track</span>(<span class="code-string">'AppService initialized'</span>);
      console.<span class="code-function">log</span>(<span class="code-string">'AnalyticsService is available.'</span>);
    } <span class="code-keyword">else</span> {
      console.<span class="code-function">log</span>(<span class="code-string">'AnalyticsService is not available, proceeding without it.'</span>);
    }
  }

  <span class="code-function">doSomething</span>() {
    <span class="code-comment">// ä½¿ç”¨å‰éœ€è¦æ£€æŸ¥æ˜¯å¦å­˜åœ¨ (ä½¿ç”¨å¯é€‰é“¾ ?. æ›´ç®€æ´)</span>
    <span class="code-keyword">this</span>.analyticsService?.<span class="code-function">track</span>(<span class="code-string">'Action performed'</span>);
    console.<span class="code-function">log</span>(<span class="code-string">'Doing something...'</span>);
  }
}</code></pre>
        <p>è¿™åœ¨å¼€å‘æ’ä»¶ç³»ç»Ÿæˆ–å¯é€‰åŠŸèƒ½æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p>

        <h3>å±æ€§æ³¨å…¥</h3>
        <p>
          é™¤äº†æ„é€ å‡½æ•°æ³¨å…¥ï¼ŒNest ä¹Ÿæ”¯æŒå±æ€§æ³¨å…¥ï¼ˆProperty-based
          Injectionï¼‰ã€‚è¿™é€šå¸¸é€šè¿‡ <code>@Inject()</code> è£…é¥°å™¨å®ç°ï¼š
        </p>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { Injectable, Inject } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;
<span class="code-keyword">import</span> { ConfigService } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/config'</span>; <span class="code-comment">// å‡è®¾ ConfigService å·²æ³¨å†Œ</span>

<span class="code-decorator">@Injectable()</span>
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">CatsService</span> {
  <span class="code-comment">// ä½¿ç”¨ @Inject() è¿›è¡Œå±æ€§æ³¨å…¥</span>
  <span class="code-decorator">@Inject</span>(ConfigService) <span class="code-comment">// æˆ–è€… @Inject('CONFIG_SERVICE_TOKEN') å¦‚æœä½¿ç”¨ token</span>
  <span class="code-keyword">private</span> <span class="code-keyword">readonly</span> configService: ConfigService;

  <span class="code-comment">// æ³¨æ„ï¼šå±æ€§æ³¨å…¥çš„ä¾èµ–åœ¨æ„é€ å‡½æ•°æ‰§è¡Œæ—¶å¯èƒ½è¿˜æœªè¢«æ³¨å…¥ï¼</span>
  <span class="code-comment">// å› æ­¤ï¼Œä¸å»ºè®®åœ¨æ„é€ å‡½æ•°ä¸­ç›´æ¥ä½¿ç”¨è¿™äº›å±æ€§ã€‚</span>
  <span class="code-keyword">constructor</span>() {
    <span class="code-comment">// console.log(this.configService.get('some_key')); // å¯èƒ½å‡ºé”™ï¼</span>
  }

  <span class="code-comment">// åœ¨æ–¹æ³•ä¸­ä½¿ç”¨æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºæ­¤æ—¶æ³¨å…¥å·²å®Œæˆ</span>
  <span class="code-function">getSettings</span>() {
    <span class="code-comment">// ç¡®ä¿ configService å·²ç»è¢«æ³¨å…¥</span>
    <span class="code-keyword">if</span> (!<span class="code-keyword">this</span>.configService) {
        <span class="code-keyword">throw</span> <span class="code-keyword">new</span> <span class="code-class">Error</span>(<span class="code-string">'ConfigService not injected'</span>);
    }
    <span class="code-keyword">return</span> <span class="code-keyword">this</span>.configService.<span class="code-function">get</span>(<span class="code-string">'cats'</span>); <span class="code-comment">// å‡è®¾é…ç½®ä¸­æœ‰ 'cats' é”®</span>
  }
}</code></pre>
        <p>
          ä¸è¿‡ï¼Œ<strong class="highlight">é€šå¸¸è¿˜æ˜¯æ¨èç”¨æ„é€ å‡½æ•°æ³¨å…¥</strong
          >ï¼Œå› ä¸ºå®ƒæœ‰å‡ ä¸ªä¼˜ç‚¹ï¼š
        </p>
        <ul>
          <li>ä¾èµ–å…³ç³»æ›´æ¸…æ™°ï¼Œç±»çš„æ‰€æœ‰ä¾èµ–éƒ½åœ¨æ„é€ å‡½æ•°ç­¾åä¸­æ˜ç¡®åˆ—å‡ºã€‚</li>
          <li>æ›´ä¾¿äºå•å…ƒæµ‹è¯•ï¼Œå¯ä»¥ç›´æ¥åœ¨æµ‹è¯•ä¸­æ¨¡æ‹Ÿå’Œä¼ å…¥ä¾èµ–ã€‚</li>
          <li>ç¡®ä¿ä¾èµ–åœ¨ç±»çš„å®ä¾‹æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰å°±å·²ç»å¯ç”¨ã€‚</li>
          <li>å±æ€§å¯ä»¥å£°æ˜ä¸º <code>readonly</code>ï¼Œå¢å¼ºä¸å˜æ€§ã€‚</li>
        </ul>

        <h3>æ‰‹åŠ¨è·å–å®ä¾‹</h3>
        <p>
          æœ‰æ—¶ä½ å¯èƒ½éœ€è¦åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°ã€ç¨‹åºåŒ–åœ°è·å–æä¾›è€…çš„å®ä¾‹ï¼Œè€Œä¸æ˜¯é€šè¿‡æ„é€ å‡½æ•°æˆ–å±æ€§æ³¨å…¥ã€‚è¿™å¯ä»¥é€šè¿‡æ³¨å…¥
          Nest æ ¸å¿ƒçš„ <code>ModuleRef</code> ç±»æ¥å®ç°ã€‚
        </p>
        <pre><code class="language-typescript"><span class="code-keyword">import</span> { Injectable, Inject } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/common'</span>;
<span class="code-keyword">import</span> { ModuleRef, REQUEST } <span class="code-keyword">from</span> <span class="code-string">'@nestjs/core'</span>;
<span class="code-keyword">import</span> { UserService } <span class="code-keyword">from</span> <span class="code-string">'../user/user.service'</span>; <span class="code-comment">// å‡è®¾ UserService æ˜¯å•ä¾‹</span>
<span class="code-keyword">import</span> { LoggerService } <span class="code-keyword">from</span> <span class="code-string">'../logger/logger.service'</span>; <span class="code-comment">// å‡è®¾ LoggerService æ˜¯è¯·æ±‚ä½œç”¨åŸŸ</span>

<span class="code-decorator">@Injectable</span>()
<span class="code-keyword">export</span> <span class="code-keyword">class</span> <span class="code-class">DynamicService</span> {
  <span class="code-keyword">constructor</span>(<span class="code-keyword">private</span> moduleRef: ModuleRef) {}

  <span class="code-keyword">async</span> <span class="code-function">getUserData</span>(userId: string) {
    <span class="code-comment">// 1. è·å–å•ä¾‹æˆ–ç¬æ€æä¾›è€…: ä½¿ç”¨ moduleRef.get()</span>
    <span class="code-comment">// å®ƒä¼šä»å®¹å™¨ä¸­æ£€ç´¢ç°æœ‰å®ä¾‹ï¼ˆå¦‚æœæ˜¯å•ä¾‹ï¼‰ï¼Œæˆ–åˆ›å»ºæ–°å®ä¾‹ï¼ˆç¬æ€ï¼‰</span>
    <span class="code-keyword">const</span> userService = <span class="code-keyword">this</span>.moduleRef.<span class="code-function">get</span>(UserService, { strict: <span class="code-keyword">false</span> });
    <span class="code-comment">// { strict: false } å…è®¸åœ¨éå½“å‰æ¨¡å—çš„ä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾æä¾›è€…</span>

    <span class="code-comment">// 2. è·å–è¯·æ±‚ä½œç”¨åŸŸçš„æä¾›è€…: ä½¿ç”¨ moduleRef.resolve()</span>
    <span class="code-comment">// resolve() ç”¨äºè§£æè¯·æ±‚ä½œç”¨åŸŸæˆ–ç¬æ€æä¾›è€…ï¼Œå¹¶ä¼šè€ƒè™‘å½“å‰çš„æ³¨å…¥ä¸Šä¸‹æ–‡ã€‚</span>
    <span class="code-comment">// å¯¹äºè¯·æ±‚ä½œç”¨åŸŸçš„æä¾›è€…ï¼Œå®ƒä¼šè¿”å›ä¸å½“å‰è¯·æ±‚å…³è”çš„å®ä¾‹ã€‚</span>
    <span class="code-comment">// æ³¨æ„ï¼šresolve è¿”å› Promiseï¼Œå› ä¸ºå®ƒå¯èƒ½éœ€è¦å¼‚æ­¥è§£æä¸Šä¸‹æ–‡ã€‚</span>
    <span class="code-keyword">const</span> logger = <span class="code-keyword">await</span> <span class="code-keyword">this</span>.moduleRef.<span class="code-function">resolve</span>(LoggerService); <span class="code-comment">// éœ€è¦ await</span>
    <span class="code-comment">// å¦‚æœ DynamicService æœ¬èº«æ˜¯è¯·æ±‚ä½œç”¨åŸŸçš„ï¼Œåˆ™ resolve ä¼šä½¿ç”¨ç›¸åŒçš„è¯·æ±‚ä¸Šä¸‹æ–‡</span>

    logger.<span class="code-function">log</span>(<span class="code-string">`Getting user data for </span><span class="code-interpolation">${userId}</span><span class="code-string">`</span>);
    <span class="code-keyword">return</span> userService.<span class="code-function">findById</span>(userId); <span class="code-comment">// è°ƒç”¨è·å–åˆ°çš„æœåŠ¡çš„æ–¹æ³•</span>
  }

  <span class="code-keyword">async</span> <span class="code-function">getServiceByName</span>(serviceName: string) {
    <span class="code-keyword">try</span> {
      <span class="code-comment">// ä¹Ÿå¯ä»¥æ ¹æ®å­—ç¬¦ä¸² token åŠ¨æ€è·å–æœåŠ¡</span>
      <span class="code-comment">// åŒæ ·ï¼Œä½¿ç”¨ get() è·å–å•ä¾‹/ç¬æ€ï¼Œresolve() è·å–è¯·æ±‚ä½œç”¨åŸŸ/ç¬æ€</span>
      <span class="code-keyword">const</span> service = <span class="code-keyword">this</span>.moduleRef.<span class="code-function">get</span>(serviceName, { strict: <span class="code-keyword">false</span> });
      console.<span class="code-function">log</span>(<span class="code-string">`Successfully retrieved service: </span><span class="code-interpolation">${serviceName}</span><span class="code-string">`</span>);
      <span class="code-keyword">return</span> service;
    } <span class="code-keyword">catch</span> (error) {
      console.<span class="code-function">error</span>(<span class="code-string">`Service '</span><span class="code-interpolation">${serviceName}</span><span class="code-string">' not found or could not be retrieved.`</span>, error);
      <span class="code-keyword">return</span> <span class="code-keyword">null</span>;
    }
  }
}</code></pre>
        <p>
          <code>moduleRef.get()</code
          >ï¼šç”¨äºæ£€ç´¢å½“å‰æ³¨å…¥ä¸Šä¸‹æ–‡ä¸­çš„æä¾›è€…å®ä¾‹ï¼ˆä¸»è¦æ˜¯å•ä¾‹å’Œç¬æ€ï¼‰ã€‚
        </p>
        <p>
          <code>moduleRef.resolve()</code>ï¼šç”¨äºåŠ¨æ€è§£ææä¾›è€…å®ä¾‹ï¼Œç‰¹åˆ«æ˜¯å¯¹äº
          <strong class="highlight">è¯·æ±‚ä½œç”¨åŸŸ</strong> çš„æä¾›è€…ã€‚å®ƒä¼šè¿”å›ä¸€ä¸ª
          Promiseï¼Œè§£æä¸ºè¯¥æä¾›è€…åœ¨å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­çš„å®ä¾‹ã€‚
        </p>
        <p>
          ä½¿ç”¨
          <code>ModuleRef</code>
          æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ï¼Œä½†ä¹Ÿä½¿å¾—ä¾èµ–å…³ç³»å˜å¾—ä¸é‚£ä¹ˆæ˜ç¡®ï¼Œåº”è°¨æ…ä½¿ç”¨ã€‚
        </p>

        <h3>è‡ªå®šä¹‰æä¾›è€…</h3>
        <p>
          åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æä¾›è€…éƒ½æ˜¯åŸºäºç±»çš„ã€‚ä½† Nest
          çš„ä¾èµ–æ³¨å…¥ç³»ç»Ÿéå¸¸çµæ´»ï¼Œå®ƒä¸ä»…æ”¯æŒæä¾›ç±»ä½œä¸º Providerï¼Œè¿˜å¯ä»¥æä¾›ï¼š
        </p>
        <ul>
          <li>
            <strong>æ™®é€šå€¼ (Value Providers)ï¼š</strong> ä½¿ç”¨
            <code>useValue</code> æä¾›å¸¸é‡ã€é…ç½®å¯¹è±¡ç­‰ã€‚
          </li>
          <li>
            <strong>ç±» (Class Providers)ï¼š</strong> ä½¿ç”¨
            <code>useClass</code> æä¾›ä¸€ä¸ªç±»çš„å®ä¾‹ï¼ˆæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„é»˜è®¤æ–¹å¼ï¼‰ã€‚
          </li>
          <li>
            <strong>å·¥å‚å‡½æ•° (Factory Providers)ï¼š</strong> ä½¿ç”¨
            <code>useFactory</code>
            æ ¹æ®åŠ¨æ€é€»è¾‘ï¼ˆå¯ä»¥æ˜¯åŒæ­¥æˆ–å¼‚æ­¥ï¼‰åˆ›å»ºå’Œæä¾›å®ä¾‹ï¼ˆå¦‚ä¹‹å‰çš„æ•°æ®åº“è¿æ¥ç¤ºä¾‹ï¼‰ã€‚
          </li>
          <li>
            <strong>åˆ«å (Alias Providers)ï¼š</strong> ä½¿ç”¨
            <code>useExisting</code> ä¸ºå·²å­˜åœ¨çš„æä¾›è€…åˆ›å»ºä¸€ä¸ªåˆ«åæˆ–ä¸åŒçš„
            tokenã€‚
          </li>
        </ul>
        <p>
          è¿™ç§çµæ´»æ€§ä½¿å¾—ä½ å¯ä»¥ç”¨éå¸¸ç²¾ç»†çš„æ–¹å¼æ¥ç®¡ç†å’Œæä¾›åº”ç”¨ç¨‹åºä¸­çš„å„ç§ä¾èµ–ã€‚æˆ‘ä»¬åé¢ä¼šå•ç‹¬ä»‹ç»ä¸‹å„ç§è‡ªå®šä¹‰æä¾›è€…çš„å…·ä½“ä½¿ç”¨æ–¹å¼å’Œåœºæ™¯ã€‚
        </p>
      </section>
    </div>
    <span class="code-comment"><!-- /.container --></span>
  </body>
</html>
